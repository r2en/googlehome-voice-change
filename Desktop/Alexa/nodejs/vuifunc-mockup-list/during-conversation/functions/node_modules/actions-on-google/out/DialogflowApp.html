<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: DialogflowApp</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: DialogflowApp</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>DialogflowApp<span class="signature">(options)</span><span class="type-signature"></span></h2>
        
            <div class="class-description">This is the class that handles the communication with Dialogflow's fulfillment API.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="DialogflowApp"><span class="type-signature"></span>new DialogflowApp<span class="signature">(options)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Constructor for DialogflowApp object.
To be used in the Dialogflow fulfillment webhook logic.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">JSON configuration.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>request</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Express HTTP request object.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>response</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Express HTTP response object.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sessionStarted</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Function callback when session starts.
    Only called if webhook is enabled for welcome/triggering intents, and
    called from Web Simulator or Google Home device (i.e., not Dialogflow simulator).</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line54">line 54</a>
    </li></ul></dd>
    

    

    

    
</dl>


















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="ask"><span class="type-signature"></span>ask<span class="signature">(inputPrompt, noInputs<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Asks to collect the user's input.
<a href="https://developers.google.com/actions/policies/general-policies#user_experience">The guidelines when prompting the user for a response must be followed at all times</a>.

NOTE: Due to a bug, if you specify the no-input prompts,
the mic is closed after the 3rd prompt, so you should use the 3rd prompt
for a bye message until the bug is fixed.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>inputPrompt</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type"><a href="global.html#SimpleResponse">SimpleResponse</a></span>
|

<span class="param-type"><a href="RichResponse.html">RichResponse</a></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The input prompt
    response.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>noInputs</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Array of re-prompts when the user does not respond (max 3).</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line530">line 530</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    HTTP response.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const WELCOME_INTENT = 'input.welcome';
const NUMBER_INTENT = 'input.number';

function welcomeIntent (app) {
  app.ask('Welcome to action snippets! Say a number.',
    ['Say any number', 'Pick a number', 'We can stop here. See you soon.']);
}

function numberIntent (app) {
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="askWithCarousel"><span class="type-signature"></span>askWithCarousel<span class="signature">(inputPrompt, carousel)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Asks to collect the user's input with a carousel.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>inputPrompt</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type"><a href="RichResponse.html">RichResponse</a></span>
|

<span class="param-type"><a href="global.html#SimpleResponse">SimpleResponse</a></span>


            
            </td>

            

            

            <td class="description last">The input prompt
    response.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>carousel</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Carousel.html">Carousel</a></span>


            
            </td>

            

            

            <td class="description last">Carousel built with
    <a href="AssistantApp.html#buildCarousel">buildCarousel</a>.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line664">line 664</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    HTTP response.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request, response});
const WELCOME_INTENT = 'input.welcome';
const OPTION_INTENT = 'option.select';

function welcomeIntent (app) {
  app.askWithCarousel('Which of these looks good?',
    app.buildCarousel()
     .addItems([
       app.buildOptionItem(SELECTION_KEY_ONE,
         ['synonym of KEY_ONE 1', 'synonym of KEY_ONE 2'])
         .setTitle('Number one'),
       app.buildOptionItem(SELECTION_KEY_TWO,
         ['synonym of KEY_TWO 1', 'synonym of KEY_TWO 2'])
         .setTitle('Number two'),
     ]));
}

function optionIntent (app) {
  if (app.getSelectedOption() === SELECTION_KEY_ONE) {
    app.tell('Number one is a great choice!');
  } else {
    app.tell('Number two is a great choice!');
  }
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(OPTION_INTENT, optionIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="askWithList"><span class="type-signature"></span>askWithList<span class="signature">(inputPrompt, list)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Asks to collect the user's input with a list.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>inputPrompt</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type"><a href="RichResponse.html">RichResponse</a></span>
|

<span class="param-type"><a href="global.html#SimpleResponse">SimpleResponse</a></span>


            
            </td>

            

            

            <td class="description last">The input prompt
    response.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>list</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="List.html">List</a></span>


            
            </td>

            

            

            <td class="description last">List built with <a href="AssistantApp.html#buildList">buildList</a>.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line584">line 584</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    HTTP response.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request, response});
const WELCOME_INTENT = 'input.welcome';
const OPTION_INTENT = 'option.select';

function welcomeIntent (app) {
  app.askWithList('Which of these looks good?',
    app.buildList('List title')
     .addItems([
       app.buildOptionItem(SELECTION_KEY_ONE,
         ['synonym of KEY_ONE 1', 'synonym of KEY_ONE 2'])
         .setTitle('Title of First List Item'),
       app.buildOptionItem(SELECTION_KEY_TWO,
         ['synonym of KEY_TWO 1', 'synonym of KEY_TWO 2'])
         .setTitle('Title of Second List Item'),
     ]));
}

function optionIntent (app) {
  if (app.getSelectedOption() === SELECTION_KEY_ONE) {
    app.tell('Number one is a great choice!');
  } else {
    app.tell('Number two is a great choice!');
  }
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(OPTION_INTENT, optionIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getArgument"><span class="type-signature"></span>getArgument<span class="signature">(argName)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Get the argument value by name from the current intent. If the argument
is included in originalRequest, and is not a text argument, the entire
argument object is returned.

Note: If incoming request is using an API version under 2 (e.g. 'v1'),
the argument object will be in Proto2 format (snake_case, etc).
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>argName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Name of the argument.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line216">line 216</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Argument value matching argName
    or null if no matching argument.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const WELCOME_INTENT = 'input.welcome';
const NUMBER_INTENT = 'input.number';

function welcomeIntent (app) {
  app.ask('Welcome to action snippets! Say a number.');
}

function numberIntent (app) {
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getContext"><span class="type-signature"></span>getContext<span class="signature">(name)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Returns the incoming context by name for this intent.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The name of the Context to retrieve.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line882">line 882</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Context value matching name
    or null if no matching context.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const CONTEXT_NUMBER = 'number';
const NUMBER_ARGUMENT = 'myNumber';

function welcomeIntent (app) {
  app.setContext(CONTEXT_NUMBER);
  app.ask('Welcome to action snippets! Say a number.');
}

function numberIntent (app) {
  let context = app.getContext(CONTEXT_NUMBER);
  // context === {
  //   name: 'number',
  //   lifespan: 0,
  //   parameters: {
  //     myNumber: '23',
  //     myNumber.original: '23'
  //   }
  // }
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getContextArgument"><span class="type-signature"></span>getContextArgument<span class="signature">(contextName, argName)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Get the context argument value by name from the current intent. Context
arguments include parameters collected in previous intents during the
lifespan of the given context. If the context argument has an original
value, usually representing the underlying entity value, that will be given
as part of the return object.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>contextName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Name of the context.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>argName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Name of the argument.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line267">line 267</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Object containing value property and optional original
    property matching context argument. Null if no matching argument.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const WELCOME_INTENT = 'input.welcome';
const NUMBER_INTENT = 'input.number';
const OUT_CONTEXT = 'output_context';
const NUMBER_ARG = 'myNumberArg';

function welcomeIntent (app) {
  const parameters = {};
  parameters[NUMBER_ARG] = '42';
  app.setContext(OUT_CONTEXT, 1, parameters);
  app.ask('Welcome to action snippets! Ask me for your number.');
}

function numberIntent (app) {
  const number = app.getContextArgument(OUT_CONTEXT, NUMBER_ARG);
  // number === { value: 42 }
  app.tell('Your number is  ' + number.value);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getContexts"><span class="type-signature"></span>getContexts<span class="signature">()</span><span class="type-signature"> &rarr; {Array.&lt;<a href="global.html#Context">Context</a>>}</span></h4>
    

    



<div class="description">
    Returns the incoming contexts for this intent.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line833">line 833</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Empty if no active contexts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="global.html#Context">Context</a>></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const CONTEXT_NUMBER = 'number';
const NUMBER_ARGUMENT = 'myNumber';

function welcomeIntent (app) {
  app.setContext(CONTEXT_NUMBER);
  app.ask('Welcome to action snippets! Say a number.');
}

function numberIntent (app) {
  let contexts = app.getContexts();
  // contexts === [{
  //   name: 'number',
  //   lifespan: 0,
  //   parameters: {
  //     myNumber: '23',
  //     myNumber.original: '23'
  //   }
  // }]
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getIncomingCarousel"><span class="type-signature"></span>getIncomingCarousel<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="Carousel.html">Carousel</a>}</span></h4>
    

    



<div class="description">
    Returns the Carousel constructed in Dialogflow response builder.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line433">line 433</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Carousel created in Dialogflow. If no Carousel was created,
    an empty Carousel is returned.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Carousel.html">Carousel</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new App({request: req, response: res});

function pickOption (app) {
if (app.hasSurfaceCapability(app.SurfaceCapabilities.SCREEN_OUTPUT)) {
    app.askWithCarousel('Which of these looks good?',
      app.getIncomingCarousel().addItems(
        app.buildOptionItem('another_choice', ['Another choice']).
        setTitle('Another choice').setDescription('Choose me!')));
  } else {
    app.ask('What would you like?');
  }
}

const actionMap = new Map();
actionMap.set('pick.option', pickOption);

app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getIncomingList"><span class="type-signature"></span>getIncomingList<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="List.html">List</a>}</span></h4>
    

    



<div class="description">
    Returns the List constructed in Dialogflow response builder.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line387">line 387</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    List created in Dialogflow. If no List was created, an empty
    List is returned.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="List.html">List</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new App({request: req, response: res});

function pickOption (app) {
if (app.hasSurfaceCapability(app.SurfaceCapabilities.SCREEN_OUTPUT)) {
    app.askWithList('Which of these looks good?',
      app.getIncomingList().addItems(
        app.buildOptionItem('another_choice', ['Another choice']).
        setTitle('Another choice')));
  } else {
    app.ask('What would you like?');
  }
}

const actionMap = new Map();
actionMap.set('pick.option', pickOption);

app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getIncomingRichResponse"><span class="type-signature"></span>getIncomingRichResponse<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="RichResponse.html">RichResponse</a>}</span></h4>
    

    



<div class="description">
    Returns the RichResponse constructed in Dialogflow response builder.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line323">line 323</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    RichResponse created in Dialogflow. If no RichResponse was
    created, an empty RichResponse is returned.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="RichResponse.html">RichResponse</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new App({request: req, response: res});

function tellFact (app) {
  let fact = 'Google was founded in 1998';

  if (app.hasSurfaceCapability(app.SurfaceCapabilities.SCREEN_OUTPUT)) {
    app.ask(app.getIncomingRichResponse().addSimpleResponse('Here\'s a ' +
      'fact for you. ' + fact + ' Which one do you want to hear about ' +
      'next, Google\'s history or headquarters?'));
  } else {
    app.ask('Here\'s a fact for you. ' + fact + ' Which one ' +
      'do you want to hear about next, Google\'s history or headquarters?');
  }
}

const actionMap = new Map();
actionMap.set('tell.fact', tellFact);

app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="getIntent"><span class="type-signature"></span>getIntent<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Get the current intent. Alternatively, using a handler Map with
<a href="AssistantApp.html#handleRequest">handleRequest</a>,
the client library will automatically handle the incoming intents.
'Intent' in the Dialogflow context translates into the current action.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line174">line 174</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Intent id or null if no value (action name).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});

function responseHandler (app) {
  const intent = app.getIntent();
  switch (intent) {
    case WELCOME_INTENT:
      app.ask('Welcome to action snippets! Say a number.');
      break;

    case NUMBER_INTENT:
      const number = app.getArgument(NUMBER_ARGUMENT);
      app.tell('You said ' + number);
      break;
  }
}

app.handleRequest(responseHandler);</code></pre>



        
            

    

    
    <h4 class="name" id="getRawInput"><span class="type-signature"></span>getRawInput<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Gets the user's raw input query.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line908">line 908</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    User's raw query or null if no value.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
app.tell('You said ' + app.getRawInput());</code></pre>



        
            

    

    
    <h4 class="name" id="getSelectedOption"><span class="type-signature"></span>getSelectedOption<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Returns the option key user chose from options response.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line484">line 484</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Option key of selected item. Null if no option selected or
    if current intent is not OPTION intent.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new App({request: req, response: res});

function pickOption (app) {
  if (app.hasSurfaceCapability(app.SurfaceCapabilities.SCREEN_OUTPUT)) {
    app.askWithCarousel('Which of these looks good?',
      app.getIncomingCarousel().addItems(
        app.buildOptionItem('another_choice', ['Another choice']).
        setTitle('Another choice').setDescription('Choose me!')));
  } else {
    app.ask('What would you like?');
  }
}

function optionPicked (app) {
  app.ask('You picked ' + app.getSelectedOption());
}

const actionMap = new Map();
actionMap.set('pick.option', pickOption);
actionMap.set('option.picked', optionPicked);

app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="isRequestFromApiAi"><span class="type-signature"></span>isRequestFromApiAi<span class="signature">(key, value)</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The header key specified by the developer in the
    Dialogflow Fulfillment settings of the app.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>value</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The private value specified by the developer inside the
    fulfillment header.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    
        <dt class="important tag-deprecated">Deprecated:</dt><dd><ul class="dummy"><li>Verifies whether the request comes from Dialogflow.</li></ul></dd>
    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line117">line 117</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    True if the request comes from Dialogflow.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="isRequestFromDialogflow"><span class="type-signature"></span>isRequestFromDialogflow<span class="signature">(key, value)</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    



<div class="description">
    Verifies whether the request comes from Dialogflow.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The header key specified by the developer in the
    Dialogflow Fulfillment settings of the app.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>value</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The private value specified by the developer inside the
    fulfillment header.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line133">line 133</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    True if the request comes from Dialogflow.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setContext"><span class="type-signature"></span>setContext<span class="signature">(name, lifespan<span class="signature-attributes">opt</span>, parameters<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {null|undefined}</span></h4>
    

    



<div class="description">
    Set a new context for the current intent.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Name of the context. Dialogflow converts to lowercase.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lifespan</code></td>
            

            <td class="type">
            
                
<span class="param-type">int</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    1
                
                </td>
            

            <td class="description last">Context lifespan.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>parameters</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Context JSON parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line769">line 769</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Null if the context name is not defined.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">null</span>
|

<span class="param-type">undefined</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const CONTEXT_NUMBER = 'number';
const NUMBER_ARGUMENT = 'myNumber';

function welcomeIntent (app) {
  app.setContext(CONTEXT_NUMBER);
  app.ask('Welcome to action snippets! Say a number.');
}

function numberIntent (app) {
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
            

    

    
    <h4 class="name" id="tell"><span class="type-signature"></span>tell<span class="signature">(speechResponse)</span><span class="type-signature"> &rarr; {Object|null}</span></h4>
    

    



<div class="description">
    Tells the Assistant to render the speech response and close the mic.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>speechResponse</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type"><a href="global.html#SimpleResponse">SimpleResponse</a></span>
|

<span class="param-type"><a href="RichResponse.html">RichResponse</a></span>


            
            </td>

            

            

            <td class="description last">Final response.
    Spoken response can be SSML.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="dialogflow-app.js.html">dialogflow-app.js</a>, <a href="dialogflow-app.js.html#line730">line 730</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The response that is sent back to Assistant.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>
|

<span class="param-type">null</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const app = new DialogflowApp({request: request, response: response});
const WELCOME_INTENT = 'input.welcome';
const NUMBER_INTENT = 'input.number';

function welcomeIntent (app) {
  app.ask('Welcome to action snippets! Say a number.');
}

function numberIntent (app) {
  const number = app.getArgument(NUMBER_ARGUMENT);
  app.tell('You said ' + number);
}

const actionMap = new Map();
actionMap.set(WELCOME_INTENT, welcomeIntent);
actionMap.set(NUMBER_INTENT, numberIntent);
app.handleRequest(actionMap);</code></pre>



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ActionsSdkApp.html">ActionsSdkApp</a></li><li><a href="AssistantApp.html">AssistantApp</a></li><li><a href="BasicCard.html">BasicCard</a></li><li><a href="Carousel.html">Carousel</a></li><li><a href="Cart.html">Cart</a></li><li><a href="DialogflowApp.html">DialogflowApp</a></li><li><a href="LineItem.html">LineItem</a></li><li><a href="List.html">List</a></li><li><a href="global.html#OptionItem">OptionItem</a></li><li><a href="Order.html">Order</a></li><li><a href="OrderUpdate.html">OrderUpdate</a></li><li><a href="RichResponse.html">RichResponse</a></li></ul><h3>Global</h3><ul><li><a href="global.html#isSsml">isSsml</a></li><li><a href="global.html#reverseOrderStateInfo">reverseOrderStateInfo</a></li><li><a href="global.html#TransactionValues">TransactionValues</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Nov 15 2017 13:52:46 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>